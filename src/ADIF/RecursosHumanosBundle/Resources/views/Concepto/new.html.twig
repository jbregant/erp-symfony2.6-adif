{% extends '::base_reducido.html.twig' %}

{% block stylesheets %}
    <link href="{{ asset(theme_path ~ 'plugins/bootstrap-switch/css/bootstrap-switch.min.css') }}" rel="stylesheet" type="text/css" />
    {{ parent() }}
    <style type="text/css">
        .col-formula > .form-group.has-error{
            margin-bottom: 0px;
        }
        
        .col-formula .help-block{
            color: #b94a48;
        }
        
        .ctn_operando > .btn {
            white-space: normal;
            overflow: hidden;
            text-overflow: ellipsis;
            word-wrap: break-word;
        }
        
        .ctn_btn_operadores > .btn{
            width: 15.7%;
        }

        .ctn_btn_operandos > .ctn_operando{
            padding-left: 0;
            padding-right: 0;
            margin-bottom: 2px;
        }

        .ctn_btn_operandos > .ctn_operando > .descripcion{
            text-align: left;
        }
        
        div.tooltip-inner {
            max-width: 350px;
        }
        
        .btn.disabled {
            cursor: default;
            pointer-events: auto;
        }
    </style>
    <link href="{{ asset(theme_path ~ 'plugins/select2/select2.css') }}" rel="stylesheet" type="text/css"/>
    <link href="{{ asset(theme_path ~ 'plugins/select2/select2-metronic.css') }}" rel="stylesheet" type="text/css"/>
    <link href="{{ asset(theme_path ~ 'plugins/typeahead/typeahead.css') }}" rel="stylesheet" type="text/css"/>
{% endblock %}

{% block javascripts %}
    {{ parent() }}
    <script src="{{ asset(theme_path ~ 'plugins/select2/select2.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset(theme_path ~ 'plugins/select2/select2_locale_es.js') }}" type="text/javascript"></script>

    <script src="{{ asset(theme_path ~ 'plugins/jquery-validation/dist/jquery.validate.min.js') }}" type="text/javascript"></script>        
    <script src="{{ asset(js_path ~ 'lib/jquery.validate.messages_es.js') }}" type="text/javascript"></script>
    <script src="{{ asset(js_path ~ 'config/validation.js') }}"></script>

    <script src="{{ asset(theme_path ~ 'plugins/bootstrap-switch/js/bootstrap-switch.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset(theme_path ~ 'plugins/jquery-inputmask/jquery.inputmask.bundle.min.js') }}" type="text/javascript"></script>
    
    <script src="{{ asset(theme_path ~ 'plugins/bootstrap/js/bootstrap2-typeahead.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset(theme_path ~ 'plugins/bootstrap-hover-dropdown/bootstrap-hover-dropdown.min.js') }}" type="text/javascript"></script>

    <script src="{{ asset(theme_path ~ 'plugins/typeahead/handlebars.min.js') }}" type="text/javascript"></script>
    <script src="{{ asset(theme_path ~ 'plugins/typeahead/typeahead.min.js') }}" type="text/javascript"></script>
    
    <script src="{{ asset(js_path ~ 'config/form.js') }}"></script>

    <script src="{{ asset('js/custom/rrhh/concepto/new.js') }}" ></script>
{% endblock %}
    
{% set edit = form.vars.value.id != null %}

{% block body -%}
    <div class="portlet box blue">
        <div class="portlet-title">
            <div class="caption">
                <i class="fa fa-reorder"></i>Concepto
            </div>
            <div class="tools">
                <a href="javascript:;" class="collapse">
                </a>
            </div>
        </div>
        <div class="portlet-body form">
            {{ form_start(form, {'attr': {'class' : 'horizontal-form','novalidate': 'novalidate'} }) }}

            {% include ':Form:fieldsErrors.html.twig' %}

            {% if edit %} 
                <input type="hidden" name="_method" value="PUT" />
            {% endif %} 


            <div class="form-body">
                <div class="row">
                    <div class="col-md-6">
                        <div class="row">
                            <div class="col-md-2">
                                <div class="form-group">
                                    {{ form_label(form.codigo, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.codigo) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <div class="form-group">
                                    {{ form_label(form.descripcion, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.descripcion) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-5">
                                <div class="form-group">
                                    {{ form_label(form.leyenda, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.leyenda) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    {{ form_label(form.convenios, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.convenios) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    {{ form_label(form.cuentaContable, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.cuentaContable) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-12">
                                <div class="form-group">
                                    {{ form_label(form.idTipoConcepto, null, {'label_attr': {'class': 'control-label'}})  }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.idTipoConcepto) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    {{ form_label(form.activo, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.activo) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    {{ form_label(form.aplicaTope, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.aplicaTope) }}
                                    </div>
                                </div>
                            </div>                
                            <div class="col-md-3">
                                <div class="form-group">
                                    {{ form_label(form.integraSac, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.integraSac) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    {{ form_label(form.integraIg, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.integraIg) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    {{ form_label(form.esNovedad, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.esNovedad) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    {{ form_label(form.esAjuste, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.esAjuste) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    {{ form_label(form.esIndemnizatorio, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.esIndemnizatorio) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    {{ form_label(form.imprimeRecibo, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.imprimeRecibo) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    {{ form_label(form.imprimeLey, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.imprimeLey) }}
                                    </div>
                                </div>
                            </div>
							 <div class="col-md-3">
                                <div class="form-group">
                                    {{ form_label(form.cambiaEscalaImpuesto, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.cambiaEscalaImpuesto) }}
                                    </div>
                                </div>
                            </div>
                            <div class="col-md-3">
                                <div class="form-group">
                                    {{ form_label(form.esNegativo, null, {'label_attr': {'class': 'control-label'}}) }}
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        {{ form_widget(form.esNegativo) }}
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col-md-6">
                    <div class="row">
                        <div class="col-md-9">
                            <div class="form-group">
                                {{ form_label(form.valor, null, {'label_attr': {'class': 'control-label'}}) }}
                                <div class="input-icon right">
                                    <i class="fa"></i>
                                    {{ form_widget(form.valor) }}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-3">
                            <div class="form-group">
                                {{ form_label(form.esPorcentaje, null, {'label_attr': {'class': 'control-label'}}) }}
                                <div class="input-icon right">
                                    <i class="fa"></i>
                                    {{ form_widget(form.esPorcentaje) }}
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12 col-formula">
                            <div class="form-group">
                                {{ form_label(form.formula, null, {'label_attr': {'class': 'control-label'}}) }}
                                <div class="input-group">
                                        {{ form_widget(form.formula) }}
                                    <span class="input-group-btn">
                                        <button id="_fm_button_limpiar" type="button" class="btn red"><i class="fa-clear"></i> Limpiar</button>
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="control-label">Operadores</label>
                                <div class="clearfix ctn_btn_operadores">
                                    <btn class="btn btn-info _fm_operador" data-tipo="_fm_suma"> + </btn>
                                    <btn class="btn btn-info _fm_operador" data-tipo="_fm_resta"> - </btn>
                                    <btn class="btn btn-info _fm_operador" data-tipo="_fm_multiplicacion"> * </btn>
                                    <btn class="btn btn-info _fm_operador" data-tipo="_fm_division"> / </btn>
                                    <btn class="btn btn-info _fm_operador" data-tipo="_fm_parent_abrir"> ( </btn>
                                    <btn class="btn btn-info _fm_operador" data-tipo="_fm_parent_cerrar"> ) </btn>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="form-group">
                                <label class="control-label">N&uacute;mero</label>
                                <div class="input-group">
                                    <input type="text" class="form-control currency" value="" id="_fm_numero_input"/>                                        
                                    <span class="input-group-btn">
                                        <button id="_fm_button_agregar_numero" type="button" class="btn green" data-tipo="_fm_numero">Agregar <i class="fa fa-plus-circle"></i></button>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="control-label" for="concepto_formula">Concepto</label>
                                <div class="input-group">
                                    <div class="input-icon right">
                                        <i class="fa"></i>
                                        <select class="choice form-control" id="_fm_concepto_select">
                                            {#{% for concepto in conceptos %}
                                                <option value="#concepto_{{ concepto.codigo }}#">{{ concepto.codigo|str_pad(4,'0',0)}} - {{ concepto }}</option>
                                            {% endfor %}#}
                                        </select>
                                    </div>
                                    <span class="input-group-btn">
                                        <button id="_fm_button_agregar_concepto" type="button" class="btn green" data-tipo="_fm_concepto">Agregar <i class="fa fa-plus-circle"></i></button>
                                    </span>
                                </div>
                            </div>
                        </div>
                        <div class="col-md-12">
                            <div class="form-group">
                                <label class="control-label">Operandos</label>
                                <div class="clearfix ctn_btn_operandos">
                                    {% for formula in formulas %}
                                    <div class="col-md-12 ctn_operando">
                                        <btn class="btn col-md-4 btn-info _fm_operando nopadding tag tooltips" 
                                             data-tipo="_fm_operando"
                                             data-placement="left"
                                             data-original-title=" {{ formula.tag }} "> {{ formula.tag }} </btn>
                                        <btn class="btn col-md-8 default disabled descripcion tooltips" 
                                             data-tipo="_fm_operando"
                                             data-placement="bottom"
                                             data-original-title=" {{ formula.descripcion }} "> {{ formula.descripcion }} </btn>
                                    </div>
                                    {% endfor %}
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="form-actions right">
                <button type="button" class="btn default button-back" back-url="{{ path('conceptos') }}">Cancelar</button>
                {{ form_widget(form.submit, {'attr': {'class': 'btn blue'}}) }}
            </div>
            {{ form_widget(form._token) }}
            {{ form_end(form, {"render_rest": false}) }}
        </div>
    </div>
{% endblock %}
